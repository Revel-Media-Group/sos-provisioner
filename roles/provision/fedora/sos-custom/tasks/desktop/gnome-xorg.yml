---
- name: install xorg packages
  # package:
  #   name:
  #     - '@base-x'
  #     - xterm
  #   state: present
  command: dnf install @base-x xterm -y

- name: install /etc/gdm/custom.conf
  copy:
    src: gdm/custom.conf
    dest: /etc/gdm/custom.conf

# - name: install custom chromium.service
#   copy:
#     src: systemd/gnome/chromium.service
#     dest: /etc/systemd/system/chromium.service
# 
# - name: install custom waychromium script
#   copy:
#     src: systemd/gnome/chromium.service
#     dest: /usr/sbin/waychromium
# 
# - name: enable chromium service
#   service:
#     name: chromium
#     enabled: true
#     state: started

- name: pip install psutil
  become: true
  become_user: '{{ user }}'
  pip:
    name: psutil
    state: present

- name: Disable idle screen turnoff
  become: true
  become_user: '{{ user }}'
  community.general.dconf:
    key: /org/gnome/desktop/session/idle-delay
    value: uint32 0
    state: present

- name: Disable suspend on AC power
  become: true
  become_user: '{{ user }}'
  community.general.dconf:
    key: /org/gnome/settings-daemon/plugins/power/sleep-inactive-ac-type
    value: "'nothing'"
    state: present

- name: Disable suspend on battery
  become: true
  become_user: '{{ user }}'
  community.general.dconf:
    key: /org/gnome/settings-daemon/plugins/power/sleep-inactive-battery-type
    value: "'nothing'"
    state: present

- name: restart gdm
  service:
    name: gdm
    enabled: true
    state: restarted
